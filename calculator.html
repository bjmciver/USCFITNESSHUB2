<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Calculator - Test</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    /* Minimal styles so this is self-contained and won't conflict */
    :root{ --accent:#73000a; }
    body{ font-family:Arial, sans-serif; background:#f6f7f8; margin:0; padding:24px; color:#222; }
    .container{ max-width:960px; margin:0 auto; padding:0 12px; }
    .calculator-section{ padding:18px 0; }
    h2{ color:var(--accent); text-align:center; margin:0 0 6px; }
    p.subtitle{ text-align:center; color:#555; margin:0 0 18px; }

    .calc-grid{ display:grid; grid-template-columns: 1fr 360px; gap:18px; align-items:start; }
    @media (max-width:880px){ .calc-grid{ grid-template-columns:1fr; } }

    .card{ background:#fff; border:1px solid #e6e6e6; border-radius:10px; padding:16px; box-shadow:0 2px 6px rgba(0,0,0,0.04); }

    label{ display:block; font-weight:700; margin:8px 0 6px; }
    input[type="number"], select { width:100%; padding:9px 10px; border:1px solid #ddd; border-radius:6px; box-sizing:border-box; }

    .goal-options{ display:flex; flex-direction:column; gap:8px; margin-top:6px; }
    .form-actions{ display:flex; gap:10px; margin-top:12px; }
    .btn{ padding:9px 14px; border-radius:8px; font-weight:700; cursor:pointer; border:none; }
    .btn-primary{ background:var(--accent); color:#fff; }
    .btn-secondary{ background:#fff; color:#111; border:1px solid #d0d0d0; }

    .calc-img{ width:100%; height:200px; object-fit:cover; border-radius:8px; display:block; }
    .result-grid{ display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:12px; }
    .result-box{ background:#f3f3f3; border-radius:8px; padding:10px; text-align:center; }
    .result-box strong{ display:block; font-size:1.2rem; color:#222; }

    /* small page footer note */
    .note{ margin-top:14px; font-size:0.9rem; color:#666; text-align:center; }
  </style>
</head>
<body>
  <div class="container">
   <section id="calc-root" class="calculator-section" aria-label="Fitness calculator">
  <div class="calc-container">
    <h2>Fitness Calculator</h2>
    <p class="section-subtitle">Enter your info below to get tailored calorie and protein goals.</p>

    <div class="calc-grid">
      <!-- FORM -->
      <div class="card form-card">
        <h3 style="margin-top:0; margin-bottom:8px;">Personal Information</h3>

        <form id="calc-form-scoped" novalidate>
          <div class="field">
            <label for="calc-height">Height (ft — decimal)</label>
            <input id="calc-height" name="height" type="number" step="0.01" placeholder="5.10" value="5.10" />
          </div>

          <div class="field">
            <label for="calc-weight">Weight (lbs)</label>
            <input id="calc-weight" name="weight" type="number" placeholder="160" value="160" />
          </div>

          <div class="field">
            <label for="calc-age">Age</label>
            <input id="calc-age" name="age" type="number" placeholder="20" value="20" />
          </div>

          <div class="field">
            <label for="calc-gender">Gender</label>
            <select id="calc-gender" name="gender" aria-label="Gender">
              <option>Male</option>
              <option>Female</option>
            </select>
          </div>

          <div class="field">
            <label for="calc-activity">Activity Level</label>
            <select id="calc-activity" name="activity" aria-label="Activity level">
              <option value="1.2">Sedentary</option>
              <option value="1.375">Lightly Active</option>
              <option value="1.55" selected>Moderately Active</option>
              <option value="1.725">Very Active</option>
            </select>
          </div>

          <div class="field">
            <label>Goal</label>
            <div class="goal-options" role="radiogroup" aria-label="Goal">
              <label><input type="radio" name="calc-goal" value="lose"> Lose Weight</label>
              <label><input type="radio" name="calc-goal" value="maintain" checked> Maintain</label>
              <label><input type="radio" name="calc-goal" value="gain"> Gain</label>
            </div>
          </div>

          <div class="form-actions" style="margin-top:12px;">
            <button type="button" id="calc-button" class="btn btn-primary">Calculate</button>
            <button type="button" id="calc-reset" class="btn btn-secondary">Reset</button>
          </div>
        </form>
      </div>

      <!-- RIGHT: image + example + user result -->
      <div>
        <div class="card">
          <img class="calc-img" src="https://images.unsplash.com/photo-1685660477895-f1b6a417466b?auto=format&fit=crop&w=1080&q=60" alt="Health device" />
        </div>

        <div class="card" style="margin-top:12px;">
          <h3 style="margin-top:0; margin-bottom:8px; text-align:center;">Example Result</h3>
          <p style="text-align:center; color:#555; margin:0 0 12px;">
            A 20-year-old student, 5’10”, 160 lbs, moderately active, trying to gain weight and muscle
          </p>
          <div class="result-grid">
            <div class="result-box"><strong>~2,700</strong><span>Calories to maintain</span></div>
            <div class="result-box"><strong>~170g</strong><span>Protein goal</span></div>
          </div>
        </div>

        <div id="user-result" class="card" style="margin-top:12px;">
          <h3 style="margin-top:0; margin-bottom:8px; text-align:center;">Your Result</h3>
          <p id="calc-summary" style="text-align:center; color:#555; margin:0 0 12px;">Fill out the form and click calculate to see your results.</p>
          <div class="result-grid">
            <div class="result-box"><strong id="calc-calories">0</strong><span>Calories to maintain</span></div>
            <div class="result-box"><strong id="calc-protein">0g</strong><span>Protein goal</span></div>
          </div>
        </div>
      </div>
    </div> <!-- .calc-grid -->
  </div> <!-- .calc-container -->

  <!-- Local CSS  -->
  <style>
    /* Scoped styles — won’t clash with other fragments */
    #calc-root .calc-container { max-width:960px; margin:0 auto; padding:0 12px; box-sizing:border-box; }
    #calc-root h2 { color: #73000a; text-align:center; margin:0 0 6px; }
    #calc-root .section-subtitle { text-align:center; color:#555; margin:0 0 18px; }

    #calc-root .calc-grid { display:grid; grid-template-columns: 1fr 360px; gap:18px; align-items:start; max-width:920px; margin:0 auto; }
    @media (max-width:880px) { #calc-root .calc-grid { grid-template-columns:1fr; } }

    #calc-root .card { background:#fff; border:1px solid #e6e6e6; border-radius:10px; padding:16px; box-shadow:0 2px 6px rgba(0,0,0,0.04); }
    #calc-root label { display:block; font-weight:700; margin:8px 0 6px; }
    #calc-root input[type="number"], #calc-root select { width:100%; padding:9px 10px; border:1px solid #ddd; border-radius:6px; box-sizing:border-box; }

    #calc-root .goal-options { display:flex; flex-direction:column; gap:8px; margin-top:6px; }
    #calc-root .form-actions { display:flex; gap:10px; margin-top:12px; }
    #calc-root .btn { padding:9px 14px; border-radius:8px; font-weight:700; cursor:pointer; border:none; }
    #calc-root .btn-primary { background:#73000a; color:#fff; }
    #calc-root .btn-secondary { background:#fff; color:#111; border:1px solid #d0d0d0; }

    #calc-root .calc-img { width:100%; height:200px; object-fit:cover; border-radius:8px; display:block; }
    #calc-root .result-grid { display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:12px; }
    #calc-root .result-box { background:#f3f3f3; border-radius:8px; padding:10px; text-align:center; }
    @media (max-width:540px) { #calc-root .calc-img { height:160px; } #calc-root .form-actions { flex-direction:column; } #calc-root .form-actions .btn { width:100%; } }
  </style>

  <!-- SPA insertion and repeated loads -->
  <script>
    (function () {
      // guard to avoid double-binding when SPA inserts fragments multiple times
      if (window.__usc_calc_fragment_bound) return;
      window.__usc_calc_fragment_bound = true;

      const root = document.getElementById('calc-root');
      if (!root) return;

      const q = sel => root.querySelector(sel);

      function toNum(v, fallback = 0) {
        const n = parseFloat(String(v || '').trim());
        return Number.isFinite(n) ? n : fallback;
      }

      function getGoal() {
        const checked = q('input[name="calc-goal"]:checked');
        return checked && checked.value ? checked.value.toLowerCase() : 'maintain';
      }

      function updateDisplay(cal, protein, summary) {
        const c = q('#calc-calories');
        const p = q('#calc-protein');
        const s = q('#calc-summary');
        if (c) c.textContent = "~" + Math.round(cal);
        if (p) p.textContent = "~" + Math.round(protein) + "g";
        if (s) s.textContent = summary;
      }

      function computeAndShow() {
        const weight = toNum(q('#calc-weight')?.value, 160);
        const height = toNum(q('#calc-height')?.value, 5.10);
        const age = toNum(q('#calc-age')?.value, 20);
        const gender = (q('#calc-gender')?.value || 'Male').toLowerCase();
        const activity = toNum(q('#calc-activity')?.value, 1.55);
        const goal = getGoal(); // lose|maintain|gain

        // BMR (approx)
        let bmr;
        if (gender.startsWith('m')) {
          bmr = 66 + (6.23 * weight) + (12.7 * (height * 12)) - (6.8 * age);
        } else {
          bmr = 655 + (4.35 * weight) + (4.7 * (height * 12)) - (4.7 * age);
        }

        const maintenance = bmr * activity;
        const goalMultipliers = { lose: 0.85, maintain: 1.00, gain: 1.15 };
        const proteinPerLb = { lose: 1.2, maintain: 1.1, gain: 1.4 };

        const mult = goalMultipliers[goal] ?? 1;
        const calories = maintenance * mult;
        const protein = weight * (proteinPerLb[goal] ?? 1.1);

        const summary = `Based on your info: ${age} y, ${height} ft, ${weight} lbs, activity ${activity} — goal: ${goal}`;
        updateDisplay(calories, protein, summary);
      }

      // bind UI
      const calcBtn = q('#calc-button');
      const resetBtn = q('#calc-reset');
      const form = q('#calc-form-scoped');

      if (calcBtn) calcBtn.addEventListener('click', (e) => { e.preventDefault(); computeAndShow(); });
      if (resetBtn) resetBtn.addEventListener('click', (e) => { e.preventDefault(); if (form) form.reset(); updateDisplay(0,0,'Fill out the form and click calculate to see your results.'); });

      // If the user presses Enter inside the form, prevent native submit and compute
      if (form) {
        form.addEventListener('submit', function (e) {
          e.preventDefault();
          computeAndShow();
        });
      }

      // show defaults on load
      computeAndShow();
    })();
  </script>
</section>
  </div>
</body>
</html>
























