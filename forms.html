<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Forms</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <section id="forms" class="section">
  <div class="container">
    <h2 class="section-title">Feedback & Assessment Forms</h2>

    <div class="two-col">
      <!-- Fitness Assessment -->
      <div class="card">
        <h3>Fitness Assessment</h3>
        <form id="fitness-assessment-form" novalidate>
          <label for="fa-name">Name *</label>
          <input id="fa-name" name="name" type="text" required>

          <label for="fa-email">Email *</label>
          <input id="fa-email" name="email" type="email" required>

          <label>Goal</label>
<div class="goal-options">
  <label><input type="radio" name="goal" value="lose"> Lose Weight</label>
  <label><input type="radio" name="goal" value="maintain" checked> Maintain</label>
  <label><input type="radio" name="goal" value="gain"> Gain</label>
</div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary">Submit</button>
            <button type="reset" class="btn">Reset</button>
          </div>
        </form>
      </div>

      <!-- Feedback Form -->
      <div class="card">
        <h3>Feedback Form</h3>
        <form id="feedback-form" novalidate>
          <label for="fb-name">Name *</label>
          <input id="fb-name" name="name" type="text" required>

          <label for="fb-email">Email *</label>
          <input id="fb-email" name="email" type="email" required>

          <label for="fb-comments">Comments</label>
          <textarea id="fb-comments" name="comments" rows="6"></textarea>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary">Submit</button>
            <button type="reset" class="btn">Reset</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</section>
  <script>
document.addEventListener('DOMContentLoaded', () => {

  // Strict email: must contain "@" and end with .com or .net
  function isValidEmail(value) {
    return /^[^\s@]+@[^\s@]+\.(com|net)$/i.test(value.trim());
  }

  function showError(el, msg) {
    clearError(el);
    const error = document.createElement('span');
    error.className = 'error-message';
    error.textContent = msg;
    el.insertAdjacentElement('afterend', error);
    el.classList.add('invalid');
  }

  function clearError(el) {
    el.classList.remove('invalid');
    const next = el.nextElementSibling;
    if (next && next.classList.contains('error-message')) next.remove();
  }

  // Validate required text/email fields and specific rules
  function validateForm(form) {
    let valid = true;

    // Required inputs (text, email, textarea)
    form.querySelectorAll('[required]').forEach(input => {
      clearError(input);
      const val = input.value || '';
      if (!val.trim()) {
        showError(input, 'This field is required');
        valid = false;
        return;
      }
      if (input.type === 'email' && !isValidEmail(val)) {
        showError(input, 'Please enter a valid email (must contain @ and end with .com or .net)');
        valid = false;
      }
    });

    // Example: check radio group "goal" in fitness form (if present)
    const radioGroupsToCheck = [
      { name: 'goal', formId: 'fitness-assessment-form' } // add more if needed
    ];
    radioGroupsToCheck.forEach(group => {
      // only check if this validation applies to the current form
      if (form.id === group.formId) {
        const radios = form.querySelectorAll(`input[type="radio"][name="${group.name}"]`);
        if (radios.length) {
          const anyChecked = Array.from(radios).some(r => r.checked);
          // place error after last radio label / container
          const lastRadio = radios[radios.length - 1];
          // remove any previous radio error
          const existing = lastRadio.parentNode.querySelector('.error-message--radio');
          if (existing) existing.remove();
          if (!anyChecked) {
            const err = document.createElement('span');
            err.className = 'error-message error-message--radio';
            err.textContent = 'Please select a goal';
            lastRadio.insertAdjacentElement('afterend', err);
            valid = false;
          }
        }
      }
    });

    return valid;
  }

  // Attach handlers to all forms
  document.querySelectorAll('form').forEach(form => {
    // Ensure native validation won't short-circuit (should be in your markup already)
    form.setAttribute('novalidate', 'novalidate');

    form.addEventListener('submit', function (e) {
      // Strong prevention of default navigation/refresh
      e.preventDefault();
      e.stopPropagation();

      // Clear any existing radio error messages in this form
      form.querySelectorAll('.error-message--radio').forEach(n => n.remove());

      const ok = validateForm(form);
      if (!ok) {
        // keep page as-is so user can fix errors
        return;
      }

      // If you want to actually submit, do it here (AJAX or real submit)
      // Example: basic success behavior without navigating away:
      alert('✅ Form passed validation — replace this with your submit logic.');
      form.reset();
      // clear leftover inline errors after reset
      form.querySelectorAll('.error-message').forEach(n => n.remove());
      form.querySelectorAll('.invalid').forEach(i => i.classList.remove('invalid'));
    });

    // Clear errors when user types
    form.addEventListener('input', function (e) {
      if (!e.target) return;
      // for radio clicks, clear radio error messages for that group
      if (e.target.type === 'radio') {
        const name = e.target.name;
        const lastRadio = form.querySelectorAll(`input[type="radio"][name="${name}"]`);
        if (lastRadio.length) {
          form.querySelectorAll('.error-message--radio').forEach(n => n.remove());
        }
        return;
      }
      if (e.target.matches('[required], input[type="email"], textarea')) {
        clearError(e.target);
      }
    });

    // When reset is pressed, also clear error messages (protects from leftover errors)
    form.addEventListener('reset', function () {
      // run in next tick so native reset finishes
      setTimeout(() => {
        form.querySelectorAll('.error-message').forEach(n => n.remove());
        form.querySelectorAll('.invalid').forEach(i => i.classList.remove('invalid'));
      }, 0);
    });
  });

  // Helpful debug note: if a form element is named "submit" it can break JS form.submit references.
  // If you still see odd behavior, open the console and run:
  // document.querySelectorAll('[name="submit"]').length
  // If >0, consider renaming that element (e.g., name="submitBtn").
});
</script>
</body>

</html>




