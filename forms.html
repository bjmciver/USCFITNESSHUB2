<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Forms — single-file</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    /* basic layout + look */
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial; margin: 18px; color:#222; background:#f7f8fb; }
    .container { max-width: 920px; margin: 0 auto; }
    h2 { margin-bottom: 12px; }
    .debug { background:#111; color:#0f0; padding:10px; border-radius:6px; font-family: monospace; margin-bottom:16px; white-space:pre-wrap; max-height:120px; overflow:auto }
    .two-col { display:grid; grid-template-columns:1fr 1fr; gap:18px; }
    .card { padding:14px; border:1px solid #e6e9ef; border-radius:8px; background:#fff; box-shadow: 0 1px 2px rgba(0,0,0,0.03); }
    label { display:block; margin-top:10px; font-weight:600; }
    input, textarea { width:100%; padding:9px; margin-top:6px; box-sizing:border-box; border:1px solid #cfd6e3; border-radius:6px; font-size:0.95rem; }
    .form-actions { margin-top:12px; display:flex; gap:8px; }
    .btn { padding:8px 12px; border-radius:6px; border:1px solid #cfd6e3; background:#f4f6fb; cursor:pointer; }
    .btn-primary { background:#0575e6; color:#fff; border-color:rgba(0,0,0,0.06); }
    .error-message { color:#d9534f; font-size:0.95rem; margin-top:6px; display:block; }
    input.invalid, textarea.invalid { border:2px solid #d9534f; background:#fff5f5; }
    .goal-options label { display:inline-block; margin-right:12px; font-weight:400; }
    @media (max-width:700px){ .two-col{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <div class="container">
    <div id="debugPanel" class="debug">debug: loading…</div>

    <h2>Feedback & Assessment Forms</h2>

    <div class="two-col">
      <!-- Fitness Assessment -->
      <div class="card">
        <h3>Fitness Assessment</h3>
        <form id="fitness-assessment-form" novalidate>
          <label for="fa-name">Name *</label>
          <input id="fa-name" name="name" type="text" required>

          <label for="fa-email">Email *</label>
          <input id="fa-email" name="email" type="email" required>

          <label>Goal</label>
          <div class="goal-options">
            <label><input type="radio" name="goal" value="lose"> Lose Weight</label>
            <label><input type="radio" name="goal" value="maintain" checked> Maintain</label>
            <label><input type="radio" name="goal" value="gain"> Gain</label>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary">Submit</button>
            <button type="reset" class="btn">Reset</button>
          </div>
        </form>
      </div>

      <!-- Feedback Form -->
      <div class="card">
        <h3>Feedback Form</h3>
        <form id="feedback-form" novalidate>
          <label for="fb-name">Name *</label>
          <input id="fb-name" name="name" type="text" required>

          <label for="fb-email">Email *</label>
          <input id="fb-email" name="email" type="email" required>

          <label for="fb-comments">Comments</label>
          <textarea id="fb-comments" name="comments" rows="6"></textarea>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary">Submit</button>
            <button type="reset" class="btn">Reset</button>
          </div>
        </form>
      </div>
    </div>
  </div>

<script>
(function () {
  const dp = document.getElementById('debugPanel');
  function dbg(...args) {
    const txt = args.map(a => (typeof a === 'object' ? JSON.stringify(a) : String(a))).join(' ');
    console.log('validator:', txt);
    dp.textContent += '\n' + txt;
    dp.scrollTop = dp.scrollHeight;
  }

  document.addEventListener('DOMContentLoaded', () => {
    dbg('loaded — DOMContentLoaded');

    function isValidEmail(value) {
      if (!value) return false;
      return /^[^\s@]+@[^\s@]+\.(com|net)$/i.test(value.trim());
    }

    function showError(el, msg) {
      clearError(el);
      const error = document.createElement('span');
      error.className = 'error-message';
      error.textContent = msg;
      el.insertAdjacentElement('afterend', error);
      el.classList.add('invalid');
      dbg('showError for', el.id || el.name, msg);
    }

    function clearError(el) {
      if (!el) return;
      el.classList.remove('invalid');
      const next = el.nextElementSibling;
      if (next && next.classList.contains('error-message')) next.remove();
    }

    function validateForm(form) {
      let valid = true;
      const requiredInputs = Array.from(form.querySelectorAll('[required]'));
      dbg('validateForm — requiredInputs count:', requiredInputs.length, requiredInputs.map(i => i.id || i.name || i.type));

      requiredInputs.forEach(input => {
        clearError(input);
        const val = (input.value || '').toString();
        dbg('checking', input.id || input.name, 'value->', JSON.stringify(val));
        if (!val.trim()) {
          showError(input, 'This field is required');
          valid = false;
          return;
        }
        if (input.type === 'email' && !isValidEmail(val)) {
          showError(input, 'Enter a valid email (must include @ and end with .com or .net)');
          valid = false;
          return;
        }
      });

      // radio group check (fitness)
      if (form.id === 'fitness-assessment-form') {
        const radios = form.querySelectorAll('input[name="goal"]');
        const anyChecked = Array.from(radios).some(r => r.checked);
        form.querySelectorAll('.error-message--radio').forEach(n => n.remove());
        dbg('radio goal anyChecked?', anyChecked);
        if (!anyChecked) {
          const err = document.createElement('span');
          err.className = 'error-message error-message--radio';
          err.textContent = 'Please select a goal';
          radios[radios.length - 1].insertAdjacentElement('afterend', err);
          valid = false;
          dbg('radio error added');
        }
      }

      dbg('validateForm result for', form.id, valid);
      return valid;
    }

    document.querySelectorAll('form').forEach(form => {
      dbg('attaching to form', form.id);
      form.setAttribute('novalidate', 'novalidate');

      form.addEventListener('submit', function (e) {
        dbg('submit event fired for', form.id);
        e.preventDefault();
        e.stopPropagation();

        form.querySelectorAll('.error-message--radio').forEach(n => n.remove());

        const ok = validateForm(form);
        if (!ok) {
          dbg('validation failed — keeping page, focusing first invalid');
          const firstInvalid = form.querySelector('.invalid');
          if (firstInvalid && typeof firstInvalid.focus === 'function') firstInvalid.focus();
          return;
        }

        dbg('validation passed for', form.id);
        alert('✅ Form passed validation — replace with submit logic.');
        form.reset();
        form.querySelectorAll('.error-message').forEach(n => n.remove());
        form.querySelectorAll('.invalid').forEach(i => i.classList.remove('invalid'));
        dbg('form reset after success');
      });

      form.addEventListener('input', function (e) {
        if (!e.target) return;
        if (e.target.type === 'radio') {
          form.querySelectorAll('.error-message--radio').forEach(n => n.remove());
          dbg('radio input cleared for', e.target.name);
          return;
        }
        if (e.target.matches('[required], input[type="email"], textarea')) {
          clearError(e.target);
          dbg('input cleared for', e.target.id || e.target.name);
        }
      });

      form.addEventListener('reset', function () {
        setTimeout(() => {
          form.querySelectorAll('.error-message').forEach(n => n.remove());
          form.querySelectorAll('.invalid').forEach(i => i.classList.remove('invalid'));
          dbg('reset: cleared errors');
        }, 0);
      });
    });

    // defensive anchor-prevent
    document.addEventListener('click', function (e) {
      const a = e.target.closest ? e.target.closest('a') : null;
      if (a && (a.getAttribute('href') === '#' || a.getAttribute('href') === '')) {
        e.preventDefault();
        dbg('prevented anchor jump', a);
      }
    });

    dbg('validator ready — try submitting a form. Check debug panel and console.');
  });
})();
</script>
</body>
</html>




